#VRML V2.0 utf8
# X3D-to-VRML-97 XSL translation autogenerated by X3dToVrml97.xslt
# https://www.web3d.org/x3d/content/X3dToVrml97.xslt
# Generated using XSLT processor: Saxonica

# [X3D] VRML V3.0 utf8
# PROFILE Immersive
# [X3D] version=3.0
# [X3D] noNamespaceSchemaLocation=https://www.web3d.org/specifications/x3d-3.0.xsd
# [head]

# META "title" "Figure27_1VisibilitySensorDungeonSlidingDoors.x3d"
# META "creator" "Figure 27.1, The VRML 2.0 Sourcebook, Copyright [1997] By Andrea L. Ames, David R. Nadeau, and John L. Moreland"
# META "reference" "http://www.wiley.com/legacy/compbooks/vrml2sbk/ch27/27fig01.htm"
# META "translator" "Don Brutzman"
# META "created" "26 October 2000"
# META "modified" "20 October 2019"
# META "Image" "Figure27_1VisibilitySensorDungeonSlidingDoors.png"
# META "description" "A dungeon door that slides open when visible, and slides closed when not visible. When you are look away from the door it goes shut, then it reopens when you look back. Page up/down between the first two viewpoints to observe this behavior. Arrow keys also help you peek left/right. Interesting side effect: users can't back up through the closed door."
# META "identifier" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter27SensingVisibilityProximityCollision/Figure27_1VisibilitySensorDungeonSlidingDoors.x3d"
# META "generator" "X3D-Edit 3.3, https://savage.nps.edu/X3D-Edit"
# META "license" "../../license.html"

# [Scene] ========== ========== ==========

Viewpoint {
  description "Now doors open, because they are visible"
  fieldOfView 1.05
  position 0 2 10
}
Viewpoint {
  description "Now doors close, because they are not visible"
  fieldOfView 1.05
  orientation 0 1 0 -0.85
  position 0 2 5
}
NavigationInfo {
  avatarSize [ 0.5 1.6 0.5 ]
  headlight FALSE
  speed 2
  type [ "WALK" "EXAMINE" "ANY"  ] 
}
Group {
  children [
      LOD {
        range [ 20 ]
        level [
          DEF DungeonRoom Inline {
            url [ "../Chapter25LevelOfDetail/Figure25_08DungeonRoom.x3d" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_08DungeonRoom.x3d" "../Chapter25LevelOfDetail/Figure25_08DungeonRoom.wrl" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_08DungeonRoom.wrl" ]
          }
          WorldInfo {
            info [ "null node" ]
          }
        ]
      }
      Transform {
        translation 0 0 -10
        children [
            LOD {
              range [ 20 ]
              level [
                USE DungeonRoom
                WorldInfo {
                  info [ "null node" ]
                }
              ]
            }
        ]
      }
      Transform {
        translation 0 0 -5
        children [
            Inline {
              url [ "../Chapter25LevelOfDetail/Figure25_10DungeonWallWithDoorway.x3d" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_10DungeonWallWithDoorway.x3d" "../Chapter25LevelOfDetail/Figure25_10DungeonWallWithDoorway.wrl" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_10DungeonWallWithDoorway.wrl" ]
            }
        ]
      }
      Transform {
        rotation 0 1 0 1.57
        scale 1 1 2
        translation 0 0 -15
        children [
            Inline {
              url [ "../Chapter25LevelOfDetail/Figure25_07DungeonRoomWall.x3d" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_07DungeonRoomWall.x3d" "../Chapter25LevelOfDetail/Figure25_07DungeonRoomWall.wrl" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_07DungeonRoomWall.wrl" ]
            }
        ]
      }
      Transform {
        translation 0 0 -4.95
        children [
            DEF LeftDoor Transform {
              children [
                  Transform {
                    translation -0.75 0 0
                    children [
                        DEF Door Inline {
                          url [ "../Chapter25LevelOfDetail/Figure25_11DungeonDoor.x3d" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_11DungeonDoor.x3d" "../Chapter25LevelOfDetail/Figure25_11DungeonDoor.wrl" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter25LevelOfDetail/Figure25_11DungeonDoor.wrl" ]
                        }
                    ]
                  }
              ]
            }
            DEF RightDoor Transform {
              children [
                  Transform {
                    translation 0.75 0 0
                    children [
                        USE Door
                    ]
                  }
              ]
            }
            DEF DoorSense VisibilitySensor {
              center 0 1.75 0
              size 3 2.5 1
            }
        ]
      }
      Sound {
        maxBack 60
        maxFront 60
        minBack 20
        minFront 20
        source DEF OpenSound AudioClip {
          description "door clunks open"
          url [ "clunk1.wav" "../Chapter27SensingVisibilityProximityCollision/clunk1.wav" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter27SensingVisibilityProximityCollision/clunk1.wav" ]
        }
      }
      Sound {
        maxBack 60
        maxFront 60
        minBack 20
        minFront 20
        source DEF CloseSound AudioClip {
          description "door clunks shut"
          url [ "clunk1.wav" "../Chapter27SensingVisibilityProximityCollision/clunk1.wav" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Chapter27SensingVisibilityProximityCollision/clunk1.wav" ]
        }
      }
      DEF OpenClock TimeSensor {
        cycleInterval 2
      }
      DEF CloseClock TimeSensor {
        cycleInterval 2
      }
      DEF LeftOpen PositionInterpolator {
        key [ 0 1 ]
        keyValue [ 0 0 0 -1.3 0 0 ]
      }
      DEF LeftClose PositionInterpolator {
        key [ 0 1 ]
        keyValue [ -1.3 0 0 0 0 0 ]
      }
      DEF RightOpen PositionInterpolator {
        key [ 0 1 ]
        keyValue [ 0 0 0 1.3 0 0 ]
      }
      DEF RightClose PositionInterpolator {
        key [ 0 1 ]
        keyValue [ 1.3 0 0 0 0 0 ]
      }
  ]
}
# open door
ROUTE DoorSense.enterTime TO OpenSound.set_startTime
ROUTE DoorSense.exitTime TO OpenSound.set_stopTime
ROUTE DoorSense.enterTime TO OpenClock.set_startTime
ROUTE DoorSense.exitTime TO OpenClock.set_stopTime
# close door
ROUTE DoorSense.exitTime TO CloseSound.set_startTime
ROUTE DoorSense.enterTime TO CloseSound.set_stopTime
ROUTE DoorSense.exitTime TO CloseClock.set_startTime
ROUTE DoorSense.enterTime TO CloseClock.set_stopTime
# door timers
ROUTE OpenClock.fraction_changed TO LeftOpen.set_fraction
ROUTE OpenClock.fraction_changed TO RightOpen.set_fraction
ROUTE CloseClock.fraction_changed TO LeftClose.set_fraction
ROUTE CloseClock.fraction_changed TO RightClose.set_fraction
# door translations
ROUTE LeftOpen.value_changed TO LeftDoor.set_translation
ROUTE RightOpen.value_changed TO RightDoor.set_translation
ROUTE LeftClose.value_changed TO LeftDoor.set_translation
ROUTE RightClose.value_changed TO RightDoor.set_translation
