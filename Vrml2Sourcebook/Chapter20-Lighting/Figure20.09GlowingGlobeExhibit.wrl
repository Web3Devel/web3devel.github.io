#VRML V2.0 utf8
# X3D-to-VRML-97 XSL translation autogenerated by X3dToVrml97.xsl
# http://www.web3D.org/TaskGroups/x3d/translation/X3dToVrml97.xsl

# [X3D]
# [head]
# [meta] filename: Figure20.09GlowingGlobeExhibit.xml
# [meta] author: Figure 20.9, The VRML 2.0 Sourcebook, Copyright [1997] By Andrea L. Ames, David R. Nadeau, and John L. Moreland
# [meta] transcribers: Don Brutzman and Colleen Case
# [meta] revised: 29 July 2000
# [meta] description: A glowing sphere within a gothic building.
# [meta] url: http://www.web3D.org/TaskGroups/x3d/translation/examples/Vrml2.0Sourcebook/Chapter20-Lighting/Figure20.09GlowingGlobeExhibit.xml
# [meta] generator: X3D-Edit, http://www.web3D.org/TaskGroups/x3d/translation/README.X3D-Edit.html
# [Scene]

NavigationInfo {
  type [ "EXAMINE" "ANY" ]
}
Group {
  children [
    # Vaulted ceiling and columns
    DEF VAULT Inline {
      bboxCenter 0 1 0
      bboxSize 6 2 6
      url [ "../Chapter13-PointsLinesFaces/Figure13.16VaultedCeiling.wrl"
	"http://www.web3D.org/TaskGroups/x3d/translation/examples/Vrml2.0Sourcebook/Chapter13-PointsLinesFaces/Figure13.16VaultedCeiling.wrl"
	"../Chapter13-PointsLinesFaces/Figure13.16VaultedCeiling.xml"
	"http://www.web3D.org/TaskGroups/x3d/translation/examples/Vrml2.0Sourcebook/Chapter13-PointsLinesFaces/Figure13.16VaultedCeiling.wrl"
      ]
    }
    # Floor
    Transform {
      translation -8.25 0.0 -8.25
      children [
	Shape {
	  geometry ElevationGrid {
	    creaseAngle 0.2
	    height [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
	      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ]
	    solid FALSE
	    xDimension 12
	    xSpacing 1.5
	    zDimension 12
	    zSpacing 1.5
	  }
	  appearance Appearance {
	    material Material {
	      diffuseColor 0.6 0.4 0
	    }
	  }
	}
      ]
    }
    # Glowing sphere
    DEF GLOBE_TRANSFORM Transform {
      translation 0 1 0
      children [
	DEF GLOBELIGHT PointLight {
	  ambientIntensity 0.2
	  color 0.7 0.5 0
	  radius 15
	}
	Shape {
	  # No material, use emissive texturing
	  appearance Appearance {
	    texture ImageTexture {
	      url [ "fire.jpg" ]
	    }
	    textureTransform DEF FIRE_TEXTURETRANSFORM TextureTransform {
	      scale 1 1
	    }
	  }
	  geometry Sphere {
	    radius 0.2
	  }
	}
	Viewpoint {
	  description "hello orb"
	  position 0 0 3
	}
	# Tweak the globe and light a bit, just for the mystery of it all
	DEF SPINCLOCK TimeSensor {
	  cycleInterval 30
	  loop TRUE
	}
	DEF TEXTURE_SPIN_INTERPOLATOR ScalarInterpolator {
	  key [ 0 0.5 1 ]
	  keyValue [ 0 -3.14159 -6.28318 ]
	}
	# A proper tweaking of the light would account for the non-uniform nature of the fire texture, this will have to do.
	DEF LIGHT_INTENSITY_TWEAKER ScalarInterpolator {
	  key [ 0 0.2 0.35 0.5 0.65 0.85 0.95 1 ]
	  keyValue [ 1 0.7 0.3 0.5 0.75 0.85 0.4 1 ]
	}
      ]
    }
    # Pedestal pyramid
    Shape {
      appearance DEF WHITE Appearance {
	material Material {
	  diffuseColor 0.5 0.5 0.5
	  emissiveColor 0.1 0.1 0.1
	}
      }
      geometry IndexedFaceSet {
	coordIndex [ 0, 1, 4, -1, 1, 2, 4, -1,
	  2, 3, 4, -1, 3, 0, 4, -1 ]
	# coordinates around the base and then tip
	coord Coordinate {
	  point [ -0.12 0.03 0.12, 0.12 0.03 0.12,
	    0.12 0.03 -0.12, -0.12 0.03 -0.12,
	    0.0 0.63 0.0 ]
	}
      }
    }
    # Pedestal base
    Transform {
      translation 0 0.015 0
      children [
	Shape {
	  appearance USE WHITE
	  geometry Box {
	    size 0.4 0.03 0.4
	  }
	}
      ]
    }
  ]
}
ROUTE SPINCLOCK.fraction_changed TO TEXTURE_SPIN_INTERPOLATOR.set_fraction
ROUTE TEXTURE_SPIN_INTERPOLATOR.value_changed TO FIRE_TEXTURETRANSFORM.set_rotation
ROUTE SPINCLOCK.fraction_changed TO LIGHT_INTENSITY_TWEAKER.set_fraction
ROUTE LIGHT_INTENSITY_TWEAKER.value_changed TO GLOBELIGHT.set_intensity

