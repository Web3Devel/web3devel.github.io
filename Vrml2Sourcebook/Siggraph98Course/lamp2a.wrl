#VRML V2.0 utf8
# X3D-to-VRML-97 XSL translation autogenerated by X3dToVrml97.xslt
# https://www.web3d.org/x3d/content/X3dToVrml97.xslt
# Generated using XSLT processor: Saxonica

# [X3D] VRML V3.3 utf8
# PROFILE Immersive
# [X3D] version=3.3
# [X3D] noNamespaceSchemaLocation=https://www.web3d.org/specifications/x3d-3.3.xsd
# [head]

# META "title" "Lamp2a.x3d"
# META "description" "Desk lamp with light toggle switch: this file builds a desk lamp that can be moved about. Dragging on the lamp base slides the lamp back and forth. Dragging on the lamp arms turns the lamp arm. Dragging on the lamp shade turns the lamp shade. Touching the lamp's light switch (on the top of the lamp shade) turns the lamp on and off."
# META "creator" "David R. Nadeau"
# META "translator" "Don Brutzman"
# META "created" "1 July 1998"
# META "translated" "2 February 2014"
# META "modified" "3 September 2023"
# META "reference" "originals/lamp2a.wrl"
# META "reference" "http://www.siggraph.org/s98"
# META "reference" "http://www.siggraph.org/s98/conference/courses/18.html"
# META "reference" "http://www.sdsc.edu/~moreland/courses/Siggraph98/vrml97/slides/mt0430.htm"
# META "reference" "http://www.sdsc.edu/~moreland/courses/Siggraph98/vrml97/vrml97.htm"
# META "reference" "https://www.web3d.org/x3d/content/examples/X3dResources.html"
# META "identifier" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Siggraph98Course/Lamp2a.x3d"
# META "generator" "Vrml97ToX3dNist, http://ovrt.nist.gov/v2_x3d.html"
# META "generator" "X3D-Edit, https://savage.nps.edu/X3D-Edit"
# META "license" "../license.html"

# [Scene] ========== ========== ==========

# To make the lamp go on and off, a TouchSensor is routed into a 'toggle' script that alternates between TRUE and FALSE outputs, sending TRUE on the first TRUE input, then FALSE on the next TRUE input. These TRUE/FALSE values are routed into a SpotLight node within the lamp, turning it on and off.
WorldInfo {
  info [ "Copyright (c) 1997, David R. Nadeau" ]
  title "Desk lamp with light toggle switch"
}
DEF Entry Viewpoint {
  description "Entry view"
  position 0.0 0.1 1.0
}
NavigationInfo {
  headlight FALSE
}
Background {
}
DirectionalLight {
  direction 0.0 -1.0 -1.0
  intensity 0.3
}
Transform {
  translation -1.0 0.0 -1.0
  children [
      Shape {
        appearance Appearance {
          material Material {
          }
          texture ImageTexture {
            url [ "wood.jpg" "https://www.web3d.org/x3d/content/examples/Vrml2Sourcebook/Siggraph98Course/wood.jpg" ]
          }
        }
        geometry ElevationGrid {
          creaseAngle 3.14
          height [ 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ]
          xDimension 10
          xSpacing 0.25
          zDimension 10
          zSpacing 0.25
        }
      }
  ]
}
Transform {
  rotation 1.0 0.0 0.0 1.571
  translation 0.0 0.01 0.0
  children [
      DEF MoveLamp PlaneSensor {
      }
      DEF Lamp Transform {
        rotation 1.0 0.0 0.0 -1.571
        children [
            Shape {
              appearance Appearance {
                material Material {
                  diffuseColor 0.5 0.5 0.5
                }
              }
              geometry Cylinder {
                height 0.01
                radius 0.1
              }
            }
            Group {
              children [
                  DEF MoveFirstArm CylinderSensor {
                  }
                  DEF FirstArm Transform {
                    children [
                        Transform {
                          center 0.0 -0.15 0.0
                          rotation 1.0 0.0 0.0 -0.7
                          translation 0.0 0.15 0.0
                          children [
                              DEF LampArm Shape {
                                appearance DEF Red Appearance {
                                  material Material {
                                    diffuseColor 1.0 0.2 0.2
                                  }
                                }
                                geometry Cylinder {
                                  height 0.3
                                  radius 0.01
                                }
                              }
                              Group {
                                children [
                                    DEF MoveSecondArm CylinderSensor {
                                    }
                                    DEF SecondArm Transform {
                                      children [
                                          Transform {
                                            center 0.0 -0.15 0.0
                                            rotation 1.0 0.0 0.0 1.9
                                            translation 0.0 0.3 0.0
                                            children [
                                                USE LampArm
                                                Group {
                                                  children [
                                                      DEF MoveLampShade SphereSensor {
                                                        offset 1.0 0.0 0.0 -1.25
                                                      }
                                                      DEF LampShade Transform {
                                                        center 0.0 0.075 0.0
                                                        rotation 1.0 0.0 0.0 -1.25
                                                        translation 0.0 0.075 0.0
                                                        children [
                                                            Shape {
                                                              appearance USE Red
                                                              geometry Cone {
                                                                bottom FALSE
                                                                bottomRadius 0.12
                                                                height 0.15
                                                              }
                                                            }
                                                            Transform {
                                                              translation 0.0 0.075 0.0
                                                              children [
                                                                  DEF LightSwitch TouchSensor {
                                                                  }
                                                                  Shape {
                                                                    appearance Appearance {
                                                                      material Material {
                                                                        diffuseColor 1.0 1.0 1.0
                                                                      }
                                                                    }
                                                                    geometry Cylinder {
                                                                      height 0.03
                                                                      radius 0.007
                                                                    }
                                                                  }
                                                              ]
                                                            }
                                                            Transform {
                                                              translation 0.0 -0.05 0.0
                                                              children [
                                                                  DEF LampLight SpotLight {
                                                                    ambientIntensity 0.2
                                                                    beamWidth 0.6
                                                                    direction 0.0 -1.0 0.0
                                                                  }
 ### Warning:  SpotLight node location and radius are affected by translation and scaling of parent-hierarchy <Transform translation='0.0 -0.05 0.0'/>
                                                                  Shape {
                                                                    appearance Appearance {
                                                                      material DEF BulbMaterial Material {
                                                                        diffuseColor 0.0 0.0 0.0
                                                                        emissiveColor 1.0 1.0 1.0
                                                                      }
                                                                    }
                                                                    geometry Sphere {
                                                                      radius 0.05
                                                                    }
                                                                  }
                                                              ]
                                                            }
                                                        ]
                                                      }
                                                  ]
                                                }
                                            ]
                                          }
                                      ]
                                    }
                                ]
                              }
                          ]
                        }
                    ]
                  }
              ]
            }
        ]
      }
  ]
}
ROUTE MoveLamp.translation_changed TO Lamp.set_translation
ROUTE MoveFirstArm.rotation_changed TO FirstArm.set_rotation
ROUTE MoveSecondArm.rotation_changed TO SecondArm.set_rotation
ROUTE MoveLampShade.rotation_changed TO LampShade.set_rotation
DEF Toggle Script {
  field        SFBool	 on TRUE
  eventIn      SFBool	 set_active
  eventOut     SFBool	 on_changed

	url [ "javascript:
		function set_active( b, tm ) {
			// ignore button releases
			if ( b == false ) return;

			// toggle on button presses
			if ( on == true ) on = false;
			else              on = true;
			on_changed = on;
		}

    
" ]
}
ROUTE LightSwitch.isActive TO Toggle.set_active
ROUTE Toggle.on_changed TO LampLight.set_on
